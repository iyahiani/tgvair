<ui:composition template="/pages/template/layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

	<ui:define name="contenu">

		<script type="text/javascript">
			function reset() {
				$("#formAssocier")[0].reset();
			}
		</script>
		<p:messages id="idPageMessages" autoUpdate="true" closable="true"
			redisplay="false" showDetail="true" globalOnly="false" />
		<p:fieldset legend="PORTEFEUILLE DE TRAINS" styleClass="fieldSet">

			<!-- style="font-size: 45px; font-color : red ;" -->
			<h:panelGrid columns="1"
				style="border-style:solid; border-color :#FFFFFF #E0E0E0; width : auto;">

				<h:form id="tableTrains">
					<h:panelGrid columns="1"
						style="border-style:solid; border-color :#FFFFFF #E0E0E0; width : auto;">

						<p:dataTable value="#{traincatalogue.trainsCatalogue}" rows="10"
							scrollable="true" widgetVar="trainsWdg" paginatorPosition="top"
							id="tableTrains" var="trains"
							selection="#{traincatalogue.selectedTrainsCatalogue}"
							filteredValue="#{traincatalogue.filtredTrainsCatalogue}"
							selectionMode="single" editable="true" editMode="cell"
							rowKey="#{trains.numeroTrainCatalogue}" paginator="true"
							rowsPerPageTemplate="5,10,15">
							<p:ajax event="rowSelect"
								listener="#{traintocompagnie.rowSelect}"
								update=":formCompAerienne:tableCompAerienne"></p:ajax>

							<p:ajax event="cellEdit" listener="#{traincatalogue.onEdit}"
								update=":tableTrains" delay="1">
							</p:ajax>

							<p:column headerText="Numéro Train" id="num_train"
								filterMatchMode="contains"
								filterBy="#{trains.numeroTrainCatalogue}">
								<h:outputText value="#{trains.numeroTrainCatalogue}" />

							</p:column>

							<p:column headerText="Début de Validité">
								<h:outputText value="#{trains.dateDebutValidite}" />
							</p:column>

							<p:column headerText="Fin de Validité">

								<h:outputText value="#{trains.dateFinValidite}" />
							</p:column>

							<p:column headerText="heure Départ">

								<h:outputText value="#{trains.heureDepartTrainCatalogue}" />
							</p:column>

							<p:column headerText="Heure Arrivée">

								<h:outputText value="#{trains.heureArriveeTrainCatalogue}" />
							</p:column>
							<p:column headerText="Départ"
								filterBy="#{trains.originePointArret}"
								filterMatchMode="contains">
								<h:outputText value="#{trains.originePointArret}" />
							</p:column>

							<p:column headerText="Arrivée"
								filterBy="#{trains.destinationPointArret}"
								filterMatchMode="contains">
								<h:outputText value="#{trains.destinationPointArret}" />
							</p:column>
							<p:column width="50">
								<f:facet name="header"> Modifier</f:facet>
								<p:commandLink update=":modif" id="update_Train"
									oncomplete="PF('Modif').show()">
									<f:setPropertyActionListener value="#{trains}"
										target="#{traincatalogue.selectedTrainsCatalogue}" />
									<h:graphicImage name="private/image/pencil_edit1.png"
										styleClass="actionButtons">
										<p:tooltip for="update_Train"
											value=" Modifier le Train #{trains.numeroTrainCatalogue}" />
									</h:graphicImage>
								</p:commandLink>
							</p:column>
						</p:dataTable>
					</h:panelGrid>
				</h:form>

				<h:form id="formCompAerienne">
					<p:dataTable
						value="#{traintocompagnie.trainsCataloguesToCompagnies}"
						paginatorPosition="top" var="compagnie" paginator="true"
						id="tableCompAerienne" rows="10" selectionMode="single"
						rowKey="compagnie.comp" rowsPerPageTemplate="5,10,15">

						<p:column headerText="Compagnie Aérienne" id="comp">
							<h:outputText value="#{compagnie.codeCompagnieAerienne}" />
						</p:column>

						<p:column headerText="Début de Validité ">

							<h:outputText
								value="#{compagnie.dateDebutValiditeTrainCatalogueToCompagnie}" />
						</p:column>

						<p:column headerText="Fin de Validité">

							<h:outputText
								value="#{compagnie.dateFinValiditeTrainCatalogueToCompagnie}" />

						</p:column>

						<p:column headerText="Marketing Flight">

							<h:outputText
								value="#{compagnie.marketingFlightTrainCatalogueToCompagnie}" />
						</p:column>

						<p:column headerText="Quota 1ére">

							<h:outputText
								value="#{compagnie.quotaPremiereTrainCatalogueToCompagnie}" />
						</p:column>

						<p:column headerText="Quota 2éme">
							<h:outputText
								value="#{compagnie.quotaDeuxiemeTrainCatalogueToCompagnie}" />
						</p:column>
					</p:dataTable>
				</h:form>

				<h:form id="formAssocier">

					<h:panelGrid columns="2" id="ajoutTC"
						style="border-style:solid; border-color :#FFFFFF #E0E0E0; width : auto;">
						<f:facet name="header"> Associer un Train</f:facet>
						<p:outputLabel value="Compagnie Aerienne"></p:outputLabel>
						<h:selectOneMenu effect="fold" editable="true" required="true"
							value="#{traintocompagnie.codeCompagnie}" style="width : 100%">

							<f:selectItems value="#{traintocompagnie.allCompagnie}"
								id="codeComp">
							</f:selectItems>
							<p:ajax update="marketing_Flight"></p:ajax>
						</h:selectOneMenu>

						<p:outputLabel value="Début de Validité"></p:outputLabel>
						<p:calendar id="popup2" showOn="both" locale="fr" required="true"
							styleClass="dateTimeStyle"
							value="#{traintocompagnie.dateDebutValidite}"
							pattern="dd/MM/yyyy" />

						<p:outputLabel value="Fin de Validité"></p:outputLabel>
						<p:calendar id="popup3" showOn="both" locale="fr" required="true"
							styleClass="dateTimeStyle"
							value="#{traintocompagnie.dateFinValidite}" pattern="dd/MM/yyyy" />

						<p:outputLabel for="marketing_Flight" value="marketing Flight"></p:outputLabel>
						<p:inputMask mask="**9999" style="width : 100% auto;"
							id="marketing_Flight" required="true"
							value="#{traintocompagnie.marketingFlight}"></p:inputMask>

						<p:outputLabel for="Quota1" value="Quota 1ére"></p:outputLabel>
						<p:inputMask mask="*9999" id="Quota1" style="width :100% auto;"
							required="true" value="#{traintocompagnie.quota1er}"></p:inputMask>

						<p:outputLabel for="Quota2" value="Quota 2éme"></p:outputLabel>
						<p:inputMask mask="*9999" id="Quota2" style="width : 100% auto;"
							required="true" value="#{traintocompagnie.quota2em}"></p:inputMask>
						<h:panelGrid></h:panelGrid>
						<h:panelGrid columns="2">
							<p:commandButton icon="ui-icon-cancel" type="reset" title="reset"></p:commandButton>
							<p:commandButton icon="ui-icon-check" type="submit" onclick="reset()"
								title="ajouter" actionListener="#{traintocompagnie.add}"
								ajax="true">
								<p:ajax update=":formCompAerienne" delay="1"
									listener="#{traintocompagnie.reload()}"
									render="formAssocier ajoutTC" resetValues="true"></p:ajax>
							</p:commandButton>
						</h:panelGrid>
					</h:panelGrid>
				</h:form>
			</h:panelGrid>
		</p:fieldset>
		<p:dialog id="modif" widgetVar="Modif" resizable="false"
			header="Modifier Train">
			<p:messages globalOnly="false" id="message_upd" autoUpdate="true"
				showDetail="true" />
			<h:form>
				<table>
					<tr>
						<td><h:outputText value="Numero 1"></h:outputText></td>
						<td><p:inputText
								value="#{traincatalogue.selectedTrainsCatalogue.numeroTrainCatalogue1}"
								required="true">
							</p:inputText></td>

					</tr>
					<tr>
						<td><h:outputText value="Numero 2"></h:outputText></td>
						<td><p:inputText
								value="#{traincatalogue.selectedTrainsCatalogue.numeroTrainCatalogue2}"
								required="true">
							</p:inputText></td>

					</tr>

					<tr>
						<td><h:outputText value="Départ"></h:outputText></td>
						<td><p:inputText
								value="#{traincatalogue.selectedTrainsCatalogue.originePointArret}"
								required="true">
							</p:inputText></td>

					</tr>
					<tr>
						<td><h:outputText value="Arriver"></h:outputText></td>
						<td><p:inputText
								value="#{traincatalogue.selectedTrainsCatalogue.destinationPointArret}"
								required="true">
							</p:inputText></td>

					</tr>
					<tr>
						<td><h:outputText value="Heure Départ"></h:outputText></td>
						<td><p:calendar id="HeureDep" pattern="HH:mm" timeOnly="true"
								required="true"
								value="#{traincatalogue.selectedTrainsCatalogue.heureDepartTrainCatalogue}"
								locale="fr" showOn="both" /></td>

					</tr>
					<tr>
						<td><h:outputText value="Heure Arriver"></h:outputText></td>
						<td><p:calendar id="HeureArr" pattern="HH:mm" timeOnly="true"
								required="true"
								value="#{traincatalogue.selectedTrainsCatalogue.heureArriveeTrainCatalogue}"
								locale="fr" showOn="both" /></td>

					</tr>
					<tr>
						<td><h:outputText value="Début Validité"></h:outputText></td>
						<td><p:calendar showOn="both" locale="fr" required="true"
								value="#{traincatalogue.selectedTrainsCatalogue.dateDebutValidite}" />
						</td>

					</tr>
					<tr>
						<td><h:outputText value="Début Fin"></h:outputText></td>
						<td><p:calendar showOn="both" locale="fr" required="true"
								value="#{traincatalogue.selectedTrainsCatalogue.dateFinValidite}" />
						</td>

					</tr>

				</table>
				<br />
				<br />
				<p:commandButton value="ajouter" type="submit"
					actionListener="#{traincatalogue.update}" update=":tableTrains"
					oncomplete="if (#{traincatalogue.closeDialog}=true) PF('Modif').close()">
				</p:commandButton>
				<p:commandButton immediate="true" onclick="PF('Modif').close()"
					value="annuler" type="cancel"></p:commandButton>
			</h:form>
		</p:dialog>

	</ui:define>
</ui:composition>
