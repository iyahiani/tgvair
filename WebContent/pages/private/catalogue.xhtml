<ui:composition template="/pages/template/layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

	<ui:define name="contenu">

		<p:fieldset legend="PORTEFEUILLE DE TRAINS" styleClass="fieldSet">
			<h:message for="tableTrains" />
			<!-- style="font-size: 45px; font-color : red ;" -->
			<h:panelGrid columns="1"
				style="border-style:solid; border-color :#FFFFFF #E0E0E0; width : auto;">

				<h:form id="tableTrains">
					<h:panelGrid columns="1"
						style="border-style:solid; border-color :#FFFFFF #E0E0E0; width : auto;">

						<p:dataTable value="#{traincatalogue.trainsCatalogue}" rows="10"
							scrollable="true" widgetVar="trainsWdg" paginatorPosition="top"
							id="tableTrains" var="trains"
							selection="#{traincatalogue.selectedTrainsCatalogue}"
							filteredValue="#{traincatalogue.filtredTrainsCatalogue}"
							selectionMode="single" 
							editable="true" 
							editMode="cell"
							rowKey="#{trains.numeroTrainCatalogue}" paginator="true"
							rowsPerPageTemplate="5,10,15">
							<p:ajax event="rowSelect"
								listener="#{traintocompagnie.rowSelect}"
								update=":formCompAerienne:tableCompAerienne"></p:ajax>

							<p:ajax event="cellEdit" listener="#{traincatalogue.onEdit}" 
								update=":tableTrains" delay="1">
							</p:ajax>
							
							<p:column headerText="Numéro Train" id="num_train"
								filterMatchMode="contains"
								filterBy="#{trains.numeroTrainCatalogue}">
								
								<p:cellEditor> 
								<f:facet name="output">
									<h:outputText value="#{trains.numeroTrainCatalogue}" />
									</f:facet>
									<f:facet name="input">
                                    <h:inputText value="#{trains.numeroTrainCatalogue}" />
                                    </f:facet>
								</p:cellEditor>
							</p:column>
							
							<p:column headerText="Début de Validité">
								<h:outputText value="#{trains.dateDebutValidite}" />
							</p:column>

							<p:column headerText="Fin de Validité">

								<h:outputText value="#{trains.dateFinValidite}" />
							</p:column>

							<p:column headerText="heure Départ">

								<h:outputText value="#{trains.heureDepartTrainCatalogue}" />
							</p:column>

							<p:column headerText="Heure Arrivée">

								<h:outputText value="#{trains.heureArriveeTrainCatalogue}" />
							</p:column>
							<p:column headerText="Départ"
								filterBy="#{trains.originePointArret}"
								filterMatchMode="contains">
								<h:outputText value="#{trains.originePointArret}" />
							</p:column>

							<p:column headerText="Arrivée"
								filterBy="#{trains.destinationPointArret}"
								filterMatchMode="contains">
								<h:outputText value="#{trains.destinationPointArret}" />
							</p:column>
							<p:column>
								<h:commandLink value="Modifier Ce Train"
									action="#{traincatalogue.goTrain}">

								</h:commandLink>
							</p:column>
						</p:dataTable>
					</h:panelGrid>
				</h:form>

				<h:form id="formCompAerienne">
					<p:dataTable
						value="#{traintocompagnie.trainsCataloguesToCompagnies}"
						paginatorPosition="top" var="compagnie" paginator="true"
						id="tableCompAerienne" rows="10" selectionMode="single"
						rowKey="compagnie.comp" rowsPerPageTemplate="5,10,15">

						<p:column headerText="Compagnie Aérienne" id="comp">
							<h:outputText value="#{compagnie.codeCompagnieAerienne}" />
						</p:column>

						<p:column headerText="Début de Validité ">

							<h:outputText
								value="#{compagnie.dateDebutValiditeTrainCatalogueToCompagnie}" />
						</p:column>

						<p:column headerText="Fin de Validité">

							<h:outputText
								value="#{compagnie.dateFinValiditeTrainCatalogueToCompagnie}" />

						</p:column>

						<p:column headerText="Marketing Flight">

							<h:outputText
								value="#{compagnie.marketingFlightTrainCatalogueToCompagnie}" />
						</p:column>

						<p:column headerText="Quota 1ére">

							<h:outputText
								value="#{compagnie.quotaPremiereTrainCatalogueToCompagnie}" />
						</p:column>

						<p:column headerText="Quota 2éme">
							<h:outputText
								value="#{compagnie.quotaDeuxiemeTrainCatalogueToCompagnie}" />
						</p:column>
					</p:dataTable>
				</h:form>

				<h:form id="formAssocier">

					<h:panelGrid columns="2" id="ajoutTC"
						style="border-style:solid; border-color :#FFFFFF #E0E0E0; width : auto;">
						<f:facet name="header"> Associer un Train</f:facet>
						<p:outputLabel value="Compagnie Aerienne"></p:outputLabel>
						<h:selectOneMenu effect="fold" editable="true" required="true"
							value="#{traintocompagnie.codeCompagnie}" style="width : 100%">

							<f:selectItems value="#{traintocompagnie.allCompagnie}"
								id="codeComp">
							</f:selectItems>
							<p:ajax update="marketing_Flight"></p:ajax>
						</h:selectOneMenu>

						<p:outputLabel value="Début de Validité"></p:outputLabel>
						<p:calendar id="popup2" showOn="both" locale="fr" required="true"
							styleClass="dateTimeStyle"
							value="#{traintocompagnie.dateDebutValidite}"
							pattern="dd/MM/yyyy" />

						<p:outputLabel value="Fin de Validité"></p:outputLabel>
						<p:calendar id="popup3" showOn="both" locale="fr" required="true"
							styleClass="dateTimeStyle"
							value="#{traintocompagnie.dateFinValidite}" pattern="dd/MM/yyyy" />

						<p:outputLabel for="marketing_Flight" value="marketing Flight"></p:outputLabel>
						<p:inputMask mask="**9999" style="width : 100% auto;"
							id="marketing_Flight" required="true"
							value="#{traintocompagnie.marketingFlight}"></p:inputMask>

						<p:outputLabel for="Quota1" value="Quota 1ére"></p:outputLabel>
						<p:inputText id="Quota1" style="width :100% auto;" required="true"
							value="#{traintocompagnie.quota1er}"></p:inputText>

						<p:outputLabel for="Quota2" value="Quota 2éme"></p:outputLabel>
						<p:inputText id="Quota2" style="width : 100% auto;"
							required="true" value="#{traintocompagnie.quota2em}"></p:inputText>
						<h:panelGrid></h:panelGrid>
						<h:panelGrid columns="2">
							<p:commandButton icon="ui-icon-cancel" type="reset" title="reset"></p:commandButton>
							<p:commandButton icon="ui-icon-check" type="submit"
								title="ajouter" actionListener="#{traintocompagnie.add}"
								ajax="true">
								<p:ajax update=":formCompAerienne" delay="1"
									listener="#{traintocompagnie.reload()}"
									render="formAssocier ajoutTC" resetValues="true"></p:ajax>
							</p:commandButton>
						</h:panelGrid>
					</h:panelGrid>
				</h:form>
			</h:panelGrid>
		</p:fieldset>


	</ui:define>
</ui:composition>
